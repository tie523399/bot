# 商品管理功能文檔

## 功能概述

後台商品管理模組提供完整的商品生命週期管理功能，採用步驟化對話流程設計，讓管理員能夠輕鬆管理商品。

## 主要功能

### 1. 新增商品

採用6步驟對話流程：

1. **輸入商品名稱**
   - 最少2個字，最多50個字
   - 檢查重複名稱

2. **輸入商品價格**
   - 必須大於0
   - 最高999,999

3. **輸入商品庫存**
   - 0或正整數
   - 最高99,999

4. **選擇商品分類**
   - 以按鈕方式選擇
   - 顯示分類圖標和名稱

5. **輸入商品描述**（可選）
   - 最多500字
   - 輸入「無」跳過

6. **輸入商品圖片**（可選）
   - 需要http://或https://開頭
   - 輸入「無」跳過

### 2. 商品列表

- 顯示前20個商品
- 格式：名稱 - 價格 (庫存:數量)
- 點擊進入編輯介面

### 3. 商品編輯

提供完整的商品資訊展示和編輯選項：

- **基本資訊**：名稱、價格、庫存、分類
- **附加資訊**：描述、圖片、創建時間
- **狀態管理**：啟用/停用切換
- **刪除功能**：含二次確認

### 4. 庫存報表

即時統計功能：

- **總覽統計**
  - 總商品數
  - 總庫存價值

- **警示項目**
  - 無庫存商品（庫存=0）
  - 低庫存商品（庫存<10）

### 5. 商品搜尋（開發中）

- 關鍵字搜尋
- 分類篩選
- 價格區間

## 使用流程

```
/admin → 商品管理 → 選擇功能
```

## 權限控制

- 僅限管理員使用
- 檢查 ADMIN_IDS 設定

## 錯誤處理

- 輸入驗證即時回饋
- 資料庫操作異常捕獲
- 友善的錯誤提示

## 特色設計

1. **步驟化流程**：清晰的引導，降低操作錯誤
2. **即時驗證**：每步輸入都有驗證，確保資料品質
3. **靈活操作**：可隨時取消（/cancel）
4. **快速切換**：創建後可繼續新增或查看列表

## 未來優化

- [ ] 批量匯入功能
- [ ] 商品複製功能
- [ ] 價格歷史記錄
- [ ] 圖片上傳支援

## 技術實現

- 使用 `ConversationHandler` 管理對話狀態
- 透過 `user_data` 暫存輸入資料
- InlineKeyboard 提供直覺操作
- SQLAlchemy ORM 確保資料一致性 